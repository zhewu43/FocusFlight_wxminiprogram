<!--pages/profile/profile.wxml-->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¤´éƒ¨ -->
  <view class="user-header">
    <view class="user-info" bindtap="getUserInfo" wx:if="{{!userInfo.nickName}}">
      <image class="avatar" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiBmaWxsPSIjRjVGNUY1Ii8+CjxjaXJjbGUgY3g9IjUwIiBjeT0iNDAiIHI9IjE1IiBmaWxsPSIjQ0NDIi8+CjxwYXRoIGQ9Ik0yNSA3NUMyNSA2NS41IDM0LjUgNTggNDYgNThINTRDNjUuNSA1OCA3NSA2NS41IDc1IDc1VjgwSDI1Vjc1WiIgZmlsbD0iI0NDQyIvPgo8L3N2Zz4K" mode="aspectFill"></image>
      <view class="user-details">
        <text class="nickname">æ¸¸å®¢é£è¡Œå‘˜</text>
        <text class="user-id">é£è¡Œå‘˜ ID: {{userInfo.openId}}</text>
        <text class="login-hint">ç‚¹å‡»ç™»å½•è·å–å®Œæ•´æƒé™</text>
      </view>
    </view>
    
    <view class="user-info" wx:if="{{userInfo.nickName}}">
      <image class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
      <view class="user-details">
        <text class="nickname">{{userInfo.nickName}}</text>
        <text class="user-id">é£è¡Œå‘˜ ID: {{userInfo.openId}}</text>
        <text class="login-time" wx:if="{{userInfo.loginTime}}">ç™»å½•æ—¶é—´: {{loginTimeText}}</text>
      </view>
    </view>
    
    <view class="login-actions">
      <button class="login-btn" wx:if="{{!userInfo.nickName}}" bindtap="getUserInfo">
        <text class="btn-icon">ğŸ‘¤</text>
        <text class="btn-text">å¾®ä¿¡ç™»å½•</text>
      </button>
      <view class="share-actions" wx:if="{{userInfo.nickName}}">
        <button class="share-btn friend-share" open-type="share">
          <text class="btn-icon">ğŸ’¬</text>
          <text class="btn-text">åˆ†äº«ç»™å¥½å‹</text>
        </button>
        <button class="share-btn timeline-share" bindtap="shareToTimeline">
          <text class="btn-icon">ğŸŒŸ</text>
          <text class="btn-text">åˆ†äº«æœ‹å‹åœˆ</text>
        </button>
      </view>
    </view>
  </view>

  <!-- ç»Ÿè®¡æ•°æ® -->
  <view class="stats-section">
    <view class="stats-title">é£è¡Œç»Ÿè®¡</view>
    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-number">{{totalFlights}}</text>
        <text class="stat-label">æ€»èˆªç­æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{totalHours}}</text>
        <text class="stat-label">æ€»é£è¡Œæ—¶é•¿</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{totalDistance}}</text>
        <text class="stat-label">æ€»é‡Œç¨‹(km)</text>
      </view>
      <view class="stat-item clickable-stat" bindtap="viewCalendar">
        <text class="stat-number">{{continuousDays}}</text>
        <view class="stat-label-wrapper">
          <text class="stat-label">è¿ç»­å¤©æ•°</text>
          <text class="calendar-icon">ğŸ“…</text>
        </view>
        <text class="click-hint">ç‚¹å‡»æŸ¥çœ‹æ—¥å†</text>
      </view>
    </view>
  </view>

  <!-- æœ¬å‘¨ç»Ÿè®¡ -->
  <view class="week-stats">
    <view class="section-title">æœ¬å‘¨ä¸“æ³¨</view>
    <view class="week-chart">
      <view class="chart-bar" wx:for="{{weekData}}" wx:key="day">
        <view class="bar" style="height: {{item.height}}%"></view>
        <text class="day-label">{{item.day}}</text>
      </view>
    </view>
    <view class="week-summary">
      <text>æœ¬å‘¨å…±ä¸“æ³¨ {{weekTotal}} åˆ†é’Ÿ</text>
    </view>
  </view>

  <!-- æœ€è¿‘èˆªç­è®°å½• -->
  <view class="recent-flights">
    <view class="section-title">
      <text>æœ€è¿‘èˆªç­</text>
      <text class="view-all" bindtap="viewAllFlights">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>
    <view class="flight-list">
      <view class="flight-item" wx:for="{{recentFlights}}" wx:key="id">
        <view class="flight-route">
          <text class="route-text">{{item.fromCity}} â†’ {{item.toCity}}</text>
          <text class="flight-number">{{item.flightNumber}}</text>
        </view>
        <view class="flight-info">
          <text class="duration">{{item.durationText}}</text>
          <text class="date">{{item.dateText}}</text>
        </view>
        <view class="flight-status">
          <text class="status {{item.completed ? 'completed' : 'cancelled'}}">
            {{item.completed ? 'å·²å®Œæˆ' : 'å·²å–æ¶ˆ'}}
          </text>
        </view>
      </view>
    </view>
    
    <view class="empty-state" wx:if="{{recentFlights.length === 0}}">
      <text class="empty-icon">âœˆï¸</text>
      <text class="empty-text">è¿˜æ²¡æœ‰é£è¡Œè®°å½•</text>
      <text class="empty-subtitle">å¼€å§‹ä½ çš„ç¬¬ä¸€æ¬¡ä¸“æ³¨é£è¡Œå§ï¼</text>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-section">
    <view class="menu-item" bindtap="goToSettings">
      <text class="menu-icon">âš™ï¸</text>
      <text class="menu-text">è®¾ç½®</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="clearData">
      <text class="menu-icon">ğŸ—‘ï¸</text>
      <text class="menu-text">æ¸…é™¤æ•°æ®</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="aboutApp">
      <text class="menu-icon">â„¹ï¸</text>
      <text class="menu-text">å…³äºåº”ç”¨</text>
      <text class="menu-arrow">></text>
    </view>
  </view>
</view>