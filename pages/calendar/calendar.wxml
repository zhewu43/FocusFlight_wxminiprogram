<!--pages/calendar/calendar.wxml-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header">
    <view class="title">ä¸“æ³¨æ—¥å†</view>
    <view class="subtitle">è®°å½•ä½ çš„æ¯ä¸€æ¬¡ä¸“æ³¨é£è¡Œ</view>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-bar">
    <view class="stat-item">
      <text class="stat-number">{{totalFocusDays}}</text>
      <text class="stat-label">æ€»ä¸“æ³¨å¤©æ•°</text>
    </view>
    <view class="stat-item">
      <text class="stat-number">{{currentMonthFocusDays}}</text>
      <text class="stat-label">æœ¬æœˆä¸“æ³¨å¤©æ•°</text>
    </view>
  </view>

  <!-- æ—¥å†å¤´éƒ¨ -->
  <view class="calendar-header">
    <view class="month-nav">
      <button class="nav-btn" bindtap="prevMonth">â€¹</button>
      <view class="month-year">
        <text class="month-text">{{monthNames[currentMonth]}}</text>
        <text class="year-text">{{currentYear}}</text>
      </view>
      <button class="nav-btn" bindtap="nextMonth">â€º</button>
    </view>
    
    <button class="today-btn" bindtap="goToToday">å›åˆ°ä»Šå¤©</button>
  </view>

  <!-- æ˜ŸæœŸæ ‡é¢˜ -->
  <view class="week-header">
    <view class="week-day" wx:for="{{weekDays}}" wx:key="*this">
      <text>{{item}}</text>
    </view>
  </view>

  <!-- æ—¥å†ä¸»ä½“ -->
  <view class="calendar-body">
    <view class="calendar-row" wx:for="{{[0,1,2,3,4,5]}}" wx:for-item="weekIndex" wx:key="*this">
      <view class="calendar-day {{calendarDays[weekIndex * 7 + dayIndex].isCurrentMonth ? 'current-month' : 'other-month'}} {{calendarDays[weekIndex * 7 + dayIndex].isToday ? 'today' : ''}} {{calendarDays[weekIndex * 7 + dayIndex].hasFocus ? 'has-focus' : ''}}" 
            wx:for="{{[0,1,2,3,4,5,6]}}" 
            wx:for-item="dayIndex" 
            wx:key="*this"
            wx:if="{{calendarDays[weekIndex * 7 + dayIndex]}}"
            bindtap="onDayTap"
            data-day="{{calendarDays[weekIndex * 7 + dayIndex]}}">
        
        <text class="day-number">{{calendarDays[weekIndex * 7 + dayIndex].day}}</text>
        
        <!-- ä¸“æ³¨æ ‡è®° -->
        <view class="focus-indicator" wx:if="{{calendarDays[weekIndex * 7 + dayIndex].hasFocus}}">
          <view class="focus-dot"></view>
          <text class="focus-count">{{calendarDays[weekIndex * 7 + dayIndex].focusData.flights.length}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å›¾ä¾‹è¯´æ˜ -->
  <view class="legend">
    <view class="legend-item">
      <view class="legend-dot normal"></view>
      <text class="legend-text">æ™®é€šæ—¥æœŸ</text>
    </view>
    <view class="legend-item">
      <view class="legend-dot today"></view>
      <text class="legend-text">ä»Šå¤©</text>
    </view>
    <view class="legend-item">
      <view class="legend-dot focus"></view>
      <text class="legend-text">æœ‰ä¸“æ³¨è®°å½•</text>
    </view>
  </view>

  <!-- æç¤ºä¿¡æ¯ -->
  <view class="tips">
    <text class="tips-text">ğŸ’¡ ç‚¹å‡»æœ‰ä¸“æ³¨è®°å½•çš„æ—¥æœŸå¯æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</text>
  </view>
</view>