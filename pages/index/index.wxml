<!--pages/index/index.wxml-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header">
    <text class="title">é€‰æ‹©æ‚¨çš„ä¸“æ³¨èˆªç­</text>
    <text class="subtitle">é£è¡Œæ—¶é•¿å³ä¸ºä¸“æ³¨æ—¶é—´</text>
  </view>

  <!-- èˆªç­é€‰æ‹©å¡ç‰‡ -->
  <view class="flight-card">
    <!-- èµ·å§‹åœ°é€‰æ‹© -->
    <view class="city-selector">
      <view class="city-item from-city" bindtap="selectFromCity">
        <view class="city-label">èµ·é£åœ°</view>
        <view class="city-name">{{fromCity.name || 'é€‰æ‹©åŸå¸‚'}}</view>
        <view class="city-code">{{fromCity.code || ''}}</view>
        <view class="location-btn" wx:if="{{fromCity.name}}" bindtap="requestLocation">
          <text class="location-icon">ğŸ“</text>
        </view>
      </view>
      
      <!-- é£æœºå›¾æ ‡ -->
      <view class="flight-icon">
        <text class="icon">âœˆï¸</text>
      </view>
      
      <!-- ç›®çš„åœ°é€‰æ‹© -->
      <view class="city-item to-city" bindtap="selectToCity">
        <view class="city-label">ç›®çš„åœ°</view>
        <view class="city-name">{{toCity.name || 'é€‰æ‹©åŸå¸‚'}}</view>
        <view class="city-code">{{toCity.code || ''}}</view>
      </view>
    </view>

    <!-- èˆªç­ä¿¡æ¯ -->
    <view class="flight-info" wx:if="{{flightInfo.flightNumber}}">
      <view class="flight-number">èˆªç­å·: {{flightInfo.flightNumber}}</view>
      <view class="flight-time">
        <text class="duration">é£è¡Œæ—¶é•¿: {{flightInfo.durationText}}</text>
        <text class="distance">è·ç¦»: {{flightInfo.distance}}å…¬é‡Œ</text>
      </view>
      <view class="departure-time">é¢„è®¡èµ·é£: {{flightInfo.departureTime}}</view>
    </view>
  </view>

  <!-- çƒ­é—¨èˆªçº¿æ¨è -->
  <view class="popular-routes" wx:if="{{popularRoutes.length > 0}}">
    <view class="section-title">çƒ­é—¨èˆªçº¿</view>
    <scroll-view class="routes-scroll" scroll-x="true">
      <view class="route-item" wx:for="{{popularRoutes}}" wx:key="id" bindtap="selectRoute" data-route="{{item}}">
        <view class="route-cities">{{item.from}} â†’ {{item.to}}</view>
        <view class="route-time">{{item.durationText}}</view>
      </view>
    </scroll-view>
  </view>

  <!-- å¼€å§‹ä¸“æ³¨æŒ‰é’® -->
  <view class="action-area">
    <button class="start-btn" bindtap="startFocus" disabled="{{!canStart}}">
      {{canStart ? 'ç™»æœºä¸“æ³¨' : 'è¯·é€‰æ‹©èˆªç­'}}
    </button>
  </view>
</view>

<!-- åŸå¸‚é€‰æ‹©å¼¹çª— -->
<view class="city-modal" wx:if="{{showCityModal}}">
  <view class="modal-mask" bindtap="closeCityModal"></view>
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">é€‰æ‹©{{modalType === 'from' ? 'èµ·é£' : 'ç›®çš„'}}åŸå¸‚</text>
      <text class="modal-close" bindtap="closeCityModal">Ã—</text>
    </view>
    <scroll-view class="city-list" scroll-y="true">
      <view class="city-option" wx:for="{{availableCities}}" wx:key="id" bindtap="selectCity" data-city="{{item}}">
        <text class="city-name">{{item.name}}</text>
        <text class="city-code">{{item.code}}</text>
      </view>
    </scroll-view>
  </view>
</view>